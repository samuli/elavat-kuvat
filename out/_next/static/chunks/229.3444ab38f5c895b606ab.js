(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{1229:function(t,e,n){"use strict";n.r(e);var c=n(9748),r=n(7146),o=n(18),a=n(6156),i=n(1163),u=n(5277),l=n(9302),f=n(8767),s=n(6010),d=n(5969),p=n(883),h=(n(3125),n(8389)),m=n(3419),v=n(9973);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);e&&(c=c.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,c)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.default=function(t){var e=t.ref,n=t.onSearch,a=t.onRecordSelect,g=(0,c.useState)([]),_=g[0],w=g[1],b=(0,c.useState)(0),O=b[0],k=b[1],Z=(0,c.useState)(),x=Z[0],j=Z[1],N=(0,c.useState)(!1),R=N[0],P=N[1],S=(0,i.useRouter)(),E=(0,l.Z)((function(t){j(t)}),500),C=function(){return{type:"NO_RESULTS",data:x}},I=(0,c.useRef)(null),U=(0,f.useQuery)((0,p.J0)(x,20),{onSuccess:function(t){P(!1);var e=t.resultCount;k(e);var n=e>0?t.records.map((function(t){return{type:"RECORD",data:y({},t)}})):[C()];e>20&&(n=[{type:"RESULTS",data:e}].concat((0,o.Z)(n))),w(n),I.current.scrollTop=0},onError:function(t){k(0),w([C()]),P(!1)},enabled:!!x}).isFetching;(0,v.SE)(U);var D=(0,u.Kb)({id:"search",items:_,onInputValueChange:function(t){var e=t.inputValue;""!=e.trim()&&(E.cancel(),E(e.trim()))}}),T=D.isOpen,X=(D.getLabelProps,D.getMenuProps),B=D.getInputProps,L=D.getComboboxProps,M=D.highlightedIndex,V=D.getItemProps,Y=D.openMenu,z=D.closeMenu,A=D.reset,F=function(t){return"/search?lookfor=".concat(encodeURIComponent(t))};return(0,r.BX)("div",{className:"w-full md:justify-end",children:[(0,r.tZ)("div",{className:"w-full flex max-w-xl justify-center items-center",children:(0,r.tZ)("div",y(y({className:"w-full"},L()),{},{children:(0,r.tZ)("input",y(y({},B({onFocus:function(){!T&&O>0&&Y()},onKeyDown:function(t){if("Enter"===t.key){var e=t.target.value.trim();if(-1===M)t.nativeEvent.preventDownshiftDefault=!0,S.push(F(e)),j(""),n();else if("undefined"!==typeof _[M]){"RECORD"===_[M].type?S.push((0,h.Yw)(_[M].data.id)):S.push(F(x)),a()}E.cancel(),P(!1),z(),A()}},ref:e,type:"search",placeholder:"Hae..."})),{},{style:{},className:"w-full px-4 py-1 rounded-lg text-lg text-gray-900 placeholder-gray-500 focus:outline-none ring-inset focus:ring-2 focus:ring-pink-500"}))}))}),(0,r.tZ)("ul",y(y({className:(0,s.Z)("absolute overflow-y-auto w-full bg-gray-900 text-gray-100 border border-pink-500",!(T&&!R&&0!==_.length)&&"hidden")},X({ref:I})),{},{style:{maxWidth:"90%",height:"auto",maxHeight:"85vh"},children:_.map((function(t,e){return(0,c.createElement)("li",y(y({className:(n=M===e,(0,s.Z)("p-1 hover:text-gray-100",n&&"bg-gradient-to-r from-pink-500 to-pink-400"))},V({item:t,index:e})),{},{key:"hit-".concat(t).concat(e),onClick:function(){return z()}}),"RECORD"===t.type&&(0,r.tZ)(d.Z,{href:(0,h.Yw)(t.data.id),prefetch:!1,children:(0,r.tZ)("a",{children:(0,r.BX)("div",{className:"flex items-center",children:[(0,r.tZ)("div",{className:"w-10 h-8 overflow-hidden rounded-md",children:t.data.images.length>0&&(0,r.tZ)("div",{className:"mr-1",children:(0,r.tZ)(m.E,{src:t.data.images[0],width:"40",height:"50"})})}),(0,r.BX)("div",{className:"pl-1",children:[(0,r.tZ)("div",{className:"text-md overflow-clip line-clamp-1",children:t.data.title}),(0,r.BX)("div",{className:"text-sm",children:[t.data.corporateAuthors&&t.data.corporateAuthors.join(", "),t.data.year&&" ".concat(t.data.year)]})]})]})})}),"RESULTS"===t.type&&(0,r.tZ)(d.Z,{href:F(x),prefetch:!1,children:(0,r.tZ)("a",{children:(0,r.tZ)("div",{className:"pl-2 my-2",children:(0,r.BX)("div",{className:"text-md",children:["N\xe4yt\xe4 kaikki haulla ",(0,r.tZ)("span",{className:"font-bold",children:x})," ",(0,r.BX)("span",{className:"ml-1",children:["(",t.data,")"]})]})})})}),"NO_RESULTS"===t.type&&(0,r.tZ)("div",{className:"pl-2",children:(0,r.BX)("div",{className:"text-md",children:["Ei tuloksia haulla ",(0,r.tZ)("span",{className:"font-bold",children:t.data})]})}));var n}))}))]})}},3419:function(t,e,n){"use strict";n.d(e,{E:function(){return i},O:function(){return l}});var c=n(7146),r=n(6010),o=n(5796),a=n(5969),i=function(t){var e=t.src,n=t.width,r=void 0===n?300:n,o=(t.height,t.style),a=void 0===o?{}:o;return(0,c.tZ)("img",{src:"https://api.finna.fi".concat(e,"&w=").concat(r),className:"w-auto rouded-xl overflow-hidden",alt:"",style:a})},u=function(t,e){return t?(0,c.tZ)(o.ZP,{offset:100,once:!0,children:e}):e},l=function(t){var e=t.records,n=t.lazy,o=void 0===n||n;return(0,c.tZ)("div",{children:(0,c.tZ)("ul",{className:"flex flex-row flex-wrap justify-between. overflow-hidden.",children:null===e||void 0===e?void 0:e.map((function(t,e){return(0,c.tZ)("li",{role:"button",className:(0,r.Z)("px-1 mb-3 w-1/2 sm:w-1/3 md:w-1/4 h-full flex flex-col group",(null===t||void 0===t?void 0:t.id)&&"cursor-pointer"),children:(n=(null===t||void 0===t?void 0:t.id)||null,i=(0,c.BX)("div",{className:"flex flex-col",children:[(0,c.tZ)("div",{className:"overflow-hidden aspect-w-5 aspect-h-4",children:(null===t||void 0===t?void 0:t.images.length)>0&&u(o&&e>=8,(0,c.tZ)("img",{className:"object-cover object-center",src:"https://api.finna.fi".concat(t.images[0],"&w=300"),alt:""}))}),(0,c.tZ)("div",{className:"w-full bg-gray-900 pt-2 px-3 text-center text-gray-200 overflow-hidden text-sm md:text-md line-clamp-2 h-10 group-hover:text-white leading-tight",children:(null===t||void 0===t?void 0:t.title)||""})]}),n?(0,c.tZ)(a.Z,{href:"/view?id=".concat(encodeURIComponent(n)),children:(0,c.tZ)("a",{children:i})},n):i)},"record-".concat(e));var n,i}))})})}},5969:function(t,e,n){"use strict";var c=n(6156),r=n(7146),o=n(1664);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);e&&(c=c.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,c)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){(0,c.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.Z=function(t){return(0,r.tZ)(o.default,i(i({},t),{},{prefetch:!1}))}},883:function(t,e,n){"use strict";n.d(e,{rr:function(){return u},Yw:function(){return h},J0:function(){return i},zp:function(){return l},jY:function(){return d},Gg:function(){return s},yQ:function(){return r}});var c=n(9973).sk?"http://localhost:3001":"https://api.finna.fi",r=20,o=function(t,e){return"filter[]=".concat("".concat(t,':"').concat(encodeURIComponent(e),'"'))},a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=["free_online_boolean:1","datasource_str_mv:kavi","~format_ext_str_mv:1/Video/Video/","~format_ext_str_mv:1/Video/Short/","-id:kavi.elonet_elokuva_1611548","-genre_facet:katsaus"];return"undefined"!==typeof t&&!1!==t&&(t=t||[1900,"*"],e.push('search_daterange_mv:"['.concat(t[0]," TO ").concat(t[1],']"'))),e.map((function(t){return"filter[]=".concat(encodeURIComponent(t))})).join("&")},i=function(t,e){var n=["title","id","images"].map((function(t){return"field[]=".concat(t)})).join("&");return"".concat(c,"/api/v1/search?lookfor=").concat(encodeURIComponent(t),"&").concat(a(),"&").concat(n,"&limit=").concat(e)},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:["title","id","images"],f=a(i)+(n?'&filter[]=topic_facet:"'.concat(encodeURIComponent(n),'"'):"")+(o?'&filter[]=genre_facet:"'.concat(encodeURIComponent(o),'"'):""),s=l.map((function(t){return"field[]=".concat(t)})).join("&");return"".concat(c,"/api/v1/search?lookfor=").concat(encodeURIComponent(t),"&").concat(f,"&").concat(s,"&limit=").concat(u,"&page=").concat(e)},l=function(){var t=[["genre_facet","mainos"],["genre_facet","animaatio"],["genre_facet","tv-tuotanto"],["genre_facet","opetuselokuva"],["genre_facet","henkil\xf6dokumentti"],["genre_facet","ammatinkuvaus"],["genre_facet","draamadokumentti"],["genre_facet","teollisuusdokumentti"],["topic_facet","henkil\xf6autot"],["topic_facet","tehtaat"],["topic_facet","matkailu"],["topic_facet","pankit"],["topic_facet","maisema"],["topic_facet","muoti"],["topic_facet","kahvi"],["topic_facet","kaupungit"],["topic_facet","virvoitusjuomat"],["topic_facet","hygienia"],["topic_facet","elintarvikkeet"],["topic_facet","ruoanvalmistus"],["topic_facet","maatalous"],["topic_facet","myym\xe4l\xe4t"],["topic_facet","rakennukset"],["search_daterange_mv","[1950 TO 1959]"],["search_daterange_mv","[1960 TO 1969]"],["search_daterange_mv","[1970 TO 1979]"],["search_daterange_mv","[1980 TO 2000]"]],e=t[Math.floor(Math.random()*t.length)],n=a(!1)+"&"+o(e[0],e[1]),r=["title","id","images"].map((function(t){return"field[]=".concat(t)})).join("&");return"".concat(c,"/api/v1/search?").concat(n,"&").concat(r,"&limit=20&sort=first_indexed desc,id asc}")},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=a(r)+(e?"&".concat(o("topic_facet",e)):"")+(n?"&".concat(o("genre_facet",n)):""),l="facet[]=".concat(t);return"".concat(c,"/api/v1/search?lookfor=").concat(i?encodeURIComponent(i):"","&").concat(u,"&").concat(l,"&limit=0")},s=function(t,e,n,c){return f("topic_facet",e,n,c,t)},d=f("genre_facet"),p=(f("main_date_str"),["title","id","images","urls","recordPage","imageRights","rawData","buildings"]),h=function(t){var e=p.map((function(t){return"field[]=".concat(t)})).join("&");return"".concat(c,"/api/v1/record?id=").concat(t,"&").concat(e)}},3125:function(t,e,n){"use strict";n(7757)},8389:function(t,e,n){"use strict";n.d(e,{Yw:function(){return c},LP:function(){return r},Xv:function(){return o}});var c=function(t){return"/view?id=".concat(encodeURIComponent(t))},r=function(t){if("undefined"===typeof(null===t||void 0===t?void 0:t.urls))return[];var e="application/x-mpegURL";return t.urls.filter((function(t){return"undefined"!==typeof t.videoSources&&t.videoSources.find((function(t){return t.type===e}))})).map((function(t){return{src:t.videoSources.find((function(t){return t.type==e})).src,title:t.text}}))},o=function(t){return"https://finna.fi".concat(t)}},9973:function(t,e,n){"use strict";n.d(e,{cm:function(){return l},lI:function(){return f},Pv:function(){return s},cC:function(){return d},SE:function(){return p},pz:function(){return h},sk:function(){return m}});n(7757);var c=n(9302),r=n(9748),o=(n(883),n(3125),n(8593)),a=n.n(o),i={1900:"1900-",1910:"1910-",1920:"1920-",1930:"1930-",1940:"1940-",1950:"1950-",1960:"1960-",1970:"1970-",1980:"1980-",1990:"1990-",2e3:"2000-"},u={topic_facet:"topic",genre_facet:"genre"},l=function(t){return i[t]},f=function(t,e){return"/search?".concat(u[t],"=").concat(encodeURIComponent(e))},s=function(t,e){return"/browse/".concat(u[t],"/").concat(encodeURIComponent(e))},d=function(t){return t.map((function(t){return{value:t.value,translated:t.translated}}))},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=(0,c.Z)((function(){a().start()}),e);(0,r.useEffect)((function(){n.cancel(),t?n():a().done()}),[t])},h=function(t,e,n,c){return t?"hae: ".concat(t):e?"aihe: ".concat(e):n?"genre: ".concat(n):c?"aikakausi: ".concat(l(c.split("-")[0])):void 0},m=!1}}]);