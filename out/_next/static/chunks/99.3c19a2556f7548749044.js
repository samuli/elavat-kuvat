"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99],{1099:function(e,t,n){n.r(t);var r=n(9748),c=n(9485),o=n(2358),a=n(2809),i=n(6010),l=n(3893),u=n(1163),s=n(8767),f=n(9302),d=n(632),p=n(6359),h=n(3154),m=n(9009),v=n(4100);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.ref,n=e.onSearch,a=e.onRecordSelect,g=(0,r.useState)([]),O=g[0],b=g[1],_=(0,r.useState)(0),w=_[0],k=_[1],Z=(0,r.useState)(),j=Z[0],x=Z[1],N=(0,r.useState)(!1),P=N[0],E=N[1],R=(0,u.useRouter)(),S=(0,f.Z)((function(e){x(e)}),500),C=function(){return{type:"NO_RESULTS",lookfor:j||""}},D=(0,r.useRef)(null),U=(0,s.useQuery)((0,h.J0)(j||"",20),{onSuccess:function(e){E(!1);var t=e.resultCount;k(t);var n=t>0?(e.records||[]).map((function(e){return{type:"RECORD",record:y({},e)}})):[C()];t>20&&(n=[{type:"RESULTS",resultCount:t}].concat((0,o.Z)(n))),b(n),D.current&&(D.current.scrollTop=0)},onError:function(){k(0),b([C()]),E(!1)},enabled:!!j}).isFetching;(0,v.SE)(U);var I=(0,l.Kb)({id:"search",items:O,onInputValueChange:function(e){var t=e.inputValue;if(t){var n=t.trim();""!=n&&(S.cancel(),S(n))}}}),T=I.isOpen,X=I.getMenuProps,B=I.getInputProps,L=I.getComboboxProps,M=I.highlightedIndex,V=I.getItemProps,Y=I.openMenu,z=I.closeMenu,A=I.reset,F=function(e){return"/search?lookfor=".concat(encodeURIComponent(e))};return(0,c.BX)("div",{className:"w-full md:justify-end",children:[(0,c.tZ)("div",{className:"w-full flex max-w-xl justify-center items-center",children:(0,c.tZ)("div",y(y({className:"w-full"},L()),{},{children:(0,c.tZ)("input",y(y({},B({onFocus:function(){!T&&w>0&&Y()},onKeyDown:function(e){if("Enter"===e.key){var t=e.target.value.trim();if(-1===M)R.push(F(t)),x(""),n();else if("undefined"!==typeof O[M]){var r=O[M];"RECORD"===r.type?R.push((0,m.Yw)(r.record.id)):R.push(F(j)),a()}S.cancel(),E(!1),z(),A()}},ref:t,type:"search",placeholder:"Hae..."})),{},{style:{},className:"w-full px-4 py-1 rounded-lg text-lg text-gray-900 placeholder-gray-500 focus:outline-none ring-inset focus:ring-2 focus:ring-pink-500"}))}))}),(0,c.tZ)("ul",y(y({className:(0,i.Z)("absolute overflow-y-auto w-full bg-gray-900 text-gray-100 border border-pink-500",!(T&&!P&&0!==O.length)&&"hidden")},X({ref:D})),{},{style:{maxWidth:"90%",height:"auto",maxHeight:"85vh"},children:O.map((function(e,t){var n,o,a;return(0,r.createElement)("li",y(y({className:(a=M===t,(0,i.Z)("p-1 hover:text-gray-100",a&&"bg-gradient-to-r from-pink-500 to-pink-400"))},V({item:e,index:t})),{},{key:"hit-".concat(e).concat(t),onClick:function(){return z()}}),"RECORD"===e.type&&(0,c.tZ)(p.Z,{href:(0,m.Yw)(e.record.id),prefetch:!1,children:(0,c.tZ)("a",{children:(0,c.BX)("div",{className:"flex items-center",children:[(0,c.tZ)("div",{className:"w-10 h-8 overflow-hidden rounded-md",children:((null===(n=e.record)||void 0===n?void 0:n.images)||[]).length>0&&(0,c.tZ)("div",{className:"mr-1",children:(0,c.tZ)(d.E,{src:((null===(o=e.record)||void 0===o?void 0:o.images)||[])[0]||"",width:40})})}),(0,c.tZ)("div",{className:"pl-1",children:(0,c.tZ)("div",{className:"text-md overflow-clip line-clamp-1",children:e.record.title})})]})})}),"RESULTS"===e.type&&(0,c.tZ)(p.Z,{href:F(j),prefetch:!1,children:(0,c.tZ)("a",{children:(0,c.tZ)("div",{className:"pl-2 my-2",children:(0,c.BX)("div",{className:"text-md",children:["N\xe4yt\xe4 kaikki haulla ",(0,c.tZ)("span",{className:"font-bold",children:j})," ",(0,c.BX)("span",{className:"ml-1",children:["(",e.resultCount,")"]})]})})})}),"NO_RESULTS"===e.type&&(0,c.tZ)("div",{className:"pl-2",children:(0,c.BX)("div",{className:"text-md",children:["Ei tuloksia haulla ",(0,c.tZ)("span",{className:"font-bold",children:e.lookfor})]})}))}))}))]})}},632:function(e,t,n){n.d(t,{E:function(){return i},O:function(){return s}});var r=n(9485),c=n(6010),o=(n(9748),n(617)),a=n(6359),i=function(e){var t=e.src,n=e.width,c=void 0===n?300:n,o=e.style,a=void 0===o?{}:o;return(0,r.tZ)("img",{src:"https://api.finna.fi".concat(t,"&w=").concat(c),className:"w-auto rouded-xl overflow-hidden",alt:"Esikatselukuva",style:a})},l=function(e){var t=e.key,n=e.placeholder,o=e.children;return(0,r.tZ)("li",{className:(0,c.Z)("px-1 mt-2 w-1/2 sm:w-1/3 md:w-1/4 h-full flex flex-col group",!n&&"cursor-pointer"),children:o},t)},u=function(e){var t=e.imageUrl,n=e.title;return(0,r.BX)("div",{style:{backgroundColor:"rgb(21, 30, 50)"},children:[(0,r.tZ)("div",{className:"flex. rounded-sm aspect-w-5 aspect-h-4 h-full",children:(0,r.tZ)(o.U,{duration:300,offset:100,render:function(e){return(0,r.tZ)("div",{className:"overflow-hidden h-full",children:t&&(0,r.tZ)("img",{className:"object-none object-center h-full",src:"https://api.finna.fi".concat(t,"&w=300"),alt:"Esikatselukuva",onLoad:e})})}})}),(0,r.tZ)("div",{className:"py-2 px-3 text-center text-gray-200 truncate text-center text-xs overflow-ellipsis group-hover:text-white",children:n?(0,r.tZ)("div",{className:"self-end",children:n}):(0,r.tZ)("div",{className:"self-end",children:"\xa0"})})]})},s=function(e){var t=e.records,n=e.placeholder,c=void 0!==n&&n,o=c?Array.from(Array(8)).map((function(){return{id:"",title:"",buildings:[]}})):t;return o?(0,r.tZ)("div",{children:(0,r.tZ)("ul",{className:"flex flex-row flex-wrap overflow-hidden.",children:o.map((function(e,t){return(0,r.BX)(l,{placeholder:c,children:[!c&&(0,r.tZ)(a.Z,{href:"/view?id=".concat(encodeURIComponent(e.id)),children:(0,r.tZ)("a",{className:"flex flex-col",children:(0,r.tZ)(u,{imageUrl:(null===e||void 0===e?void 0:e.images)&&e.images[0]||void 0,title:e.title})})},"link-".concat(t)),c&&(0,r.tZ)("div",{children:(0,r.tZ)(u,{})})]},"record-".concat(t))}))})}):null}},6359:function(e,t,n){var r=n(2809),c=n(9485),o=n(1664);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){return(0,c.tZ)(o.default,i(i({},e),{},{prefetch:!1,children:e.children}))}},3154:function(e,t,n){n.d(t,{J0:function(){return i},zp:function(){return u},Yw:function(){return p},yQ:function(){return c},rr:function(){return l},Gg:function(){return f}});var r=n(4100).sk?"http://localhost:3001":"https://api.finna.fi",c=20,o=function(e,t){return"filter[]=".concat("".concat(e,':"').concat(encodeURIComponent(t),'"'))},a=function(e){e=e||[1900,"*"];var t=["free_online_boolean:1","datasource_str_mv:kavi","~format_ext_str_mv:1/Video/Video/","~format_ext_str_mv:1/Video/Short/","-id:kavi.elonet_elokuva_1611548","-genre_facet:katsaus"];return t.push('search_daterange_mv:"['.concat(e[0]," TO ").concat(e[1],']"')),t.map((function(e){return"filter[]=".concat(encodeURIComponent(e))})).join("&")},i=function(e,t){var n=["title","id","images"].map((function(e){return"field[]=".concat(e)})).join("&");return"".concat(r,"/api/v1/search?lookfor=").concat(encodeURIComponent(e),"&").concat(a(),"&").concat(n,"&limit=").concat(t)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:c,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:["title","id","images"],s=a(i)+(n?'&filter[]=topic_facet:"'.concat(encodeURIComponent(n),'"'):"")+(o?'&filter[]=genre_facet:"'.concat(encodeURIComponent(o),'"'):""),f=u.map((function(e){return"field[]=".concat(e)})).join("&");return"".concat(r,"/api/v1/search?lookfor=").concat(encodeURIComponent(e),"&").concat(s,"&").concat(f,"&limit=").concat(l,"&page=").concat(t)},u=function(){var e=[["genre_facet","mainos"],["genre_facet","animaatio"],["genre_facet","tv-tuotanto"],["genre_facet","opetuselokuva"],["genre_facet","henkil\xf6dokumentti"],["genre_facet","ammatinkuvaus"],["genre_facet","draamadokumentti"],["genre_facet","teollisuusdokumentti"],["topic_facet","henkil\xf6autot"],["topic_facet","tehtaat"],["topic_facet","matkailu"],["topic_facet","pankit"],["topic_facet","maisema"],["topic_facet","muoti"],["topic_facet","kahvi"],["topic_facet","kaupungit"],["topic_facet","virvoitusjuomat"],["topic_facet","hygienia"],["topic_facet","elintarvikkeet"],["topic_facet","ruoanvalmistus"],["topic_facet","maatalous"],["topic_facet","myym\xe4l\xe4t"],["topic_facet","rakennukset"],["search_daterange_mv","[1950 TO 1959]"],["search_daterange_mv","[1960 TO 1969]"],["search_daterange_mv","[1970 TO 1979]"],["search_daterange_mv","[1980 TO 2000]"]],t=e[Math.floor(Math.random()*e.length)],n=a()+"&"+o(t[0],t[1]),c=["title","id","images"].map((function(e){return"field[]=".concat(e)})).join("&");return"".concat(r,"/api/v1/search?").concat(n,"&").concat(c,"&limit=20&sort=first_indexed desc,id asc}")},s=function(e,t,n,c,i){var l=a(c)+(t?"&".concat(o("topic_facet",t)):"")+(n?"&".concat(o("genre_facet",n)):""),u="facet[]=".concat(e);return"".concat(r,"/api/v1/search?lookfor=").concat(i?encodeURIComponent(i):"","&").concat(l,"&").concat(u,"&limit=0")},f=function(e,t,n,r){return s("topic_facet",t,n,r,e)},d=(s("genre_facet"),s("main_date_str"),["title","id","images","urls","recordPage","imageRights","rawData","buildings"]),p=function(e){var t=d.map((function(e){return"field[]=".concat(e)})).join("&");return"".concat(r,"/api/v1/record?id=").concat(e,"&").concat(t)}},9009:function(e,t,n){n.d(t,{Yw:function(){return a},LP:function(){return i},rz:function(){return l},Xv:function(){return u}});var r=n(2809);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(e){return"/view?id=".concat(encodeURIComponent(e))},i=function(e){if("undefined"===typeof e.urls)return[];var t=[];return(e.urls||[]).forEach((function(e){(e.videoSources||[]).forEach((function(n){"application/x-mpegURL"===n.type&&t.push(o(o({},n),{},{title:e.text}))}))})),t},l=function(e,t){if(e.rawData)return e.rawData[t]||void 0},u=function(e){return"https://finna.fi".concat(e)}}}]);